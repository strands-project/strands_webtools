<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />

    <!-- The default styling is provided by http://getbootstrap.com -->
    <link href="css/bootstrap.css" rel="stylesheet">
    <link href="css/main.css" rel="stylesheet">
    
    <link rel="stylesheet" type="text/css" href="css/jquery-ui.css" />

    <!-- jQuery and display.js are conveniences for interacting with the DOM -->
    <script src="js/jquery.js"></script>
    <script src="js/display.js"></script>

    <!-- ROSLIBJS -->
    <!-- EventEmitter2 is the sole dependency of roslibjs -->
    <script src="js/eventemitter2.js"></script>
    <!-- Roslibjs handles core ROS functionality in the browser -->
    <script src="js/roslib.js"></script>

    <!-- ROS2DJS -->
    <!-- EaselJS is a dependency of ros2djs -->
    <script src="js/easeljs.js"></script>
    <!-- Ros2djs provides 2D scene support, including mapping and more -->
    <script src="js/ros2d.js"></script>

    <!-- ROS3DJS -->
    <!-- Three.js is the WebGL rendering library -->
    <script src="js/three.js"></script>
    <!-- ColladaLoader2 loads collada models of the robot -->
    <script src="js/ColladaLoader2.js"></script>
    <!-- Ros3djs provides 3D scene support, including mapping and more -->
    <script src="js/ros3d.js"></script>
    

    <script type="text/javascript" src="js/jquery-ui.js"></script>


    <script type="text/javascript">
      /**
      * Setup all GUI elements when the page is loaded.
      */
      function init() {
      // Connecting to ROS.
      var ros = new ROSLIB.Ros({
      url : 'ws://localhost:9090'
      });
      // ----------------------------------------------------------------------
      // Rendering the robot in 3D
      // ----------------------------------------------------------------------

      // Create the scene manager and view port for the 3D world.
      var viewer3D = new ROS3D.Viewer({
        divID      : 'threed-map',
        width      : 600,
        height     : 300,
        antialias  : true,
        background : '#EEEEEE'
      });

      // Create a TF client that subscribes to the fixed frame.
      var tfClient = new ROSLIB.TFClient({
        ros          : ros,
        angularThres : 0.01,
        transThres   : 0.01,
        rate         : 10.0
      });

      // Add the URDF model of the robot.
      var urdfClient = new ROS3D.UrdfClient({
        ros        : ros,
        tfClient   : tfClient,
        path       : 'http://resources.robotwebtools.org/',
        rootObject : viewer3D.scene
      });

      // ----------------------------------------------------------------------
      // Rendering the map in 3D
      // ----------------------------------------------------------------------

      // Add the Occupancy Grid map.
      var grid = new ROS3D.OccupancyGridClient({
        ros        : ros,
        tfClient   : tfClient,
        rootObject : viewer3D.scene
      });
      grid.on('change', function() {
        // Change the opacity level.
        grid.currentGrid.children[0].material.transparent = true;
        grid.currentGrid.children[0].material.opacity = 0.25;
        grid.currentGrid.children[0].material.needsUpdate = true;
      });
    }
    </script>
  </head>

  <body onload="init()">
    <div class="navbar navbar-inverse navbar-fixed-top">
        <a class="navbar-brand" href="#">strands_webtools</a>      
      <ul class="nav pull-right">
      <li><a href="main.html">Main</a></li>
      <li class="active"><a href="map.html">Map</a></li>
    </ul>
    </div>

    <div class="container">
      <h1><small>3D Map</small></h1>
     
     <div class="row">
      <!-- 3D Map -->
      <div class="col-span-8">
        <div id="threed-map"></div>
      </div>
    
    </div>

  </body>
</html>
